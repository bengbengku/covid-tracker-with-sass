const buildChartData=e=>{let t,a=[];for(let o in e.cases){if(t){let l={x:o,y:e.cases[o]-t};a.push(l)}t=e.cases[o]}return a},buildChart=e=>{var t=document.getElementById("myChart").getContext("2d");new Chart(t,{type:"line",data:{datasets:[{label:"ðŸ¤¢Total Kasus",backgroundColor:"rgba(244, 144, 128, 0.8)",borderColor:"#cc1034",data:e}]},options:{maintainAspectRatio:!1,tooltips:{mode:"index",intersect:!1},elements:{point:{radius:0}},scales:{xAxes:[{type:"time",time:{format:"MM/DD/YY",tooltipFormat:"ll"},ticks:{padding:20}}],yAxes:[{gridLines:{display:!1},ticks:{padding:20,callback:function(e,t,a){return numeral(e).format("0a")}}}]}}})},buildPieChart=e=>{var t=document.getElementById("myPieChart").getContext("2d");new Chart(t,{type:"pie",data:{datasets:[{data:[e.active,e.recovered,e.deaths],backgroundColor:["#9d80fe","#7dd71d","#fb4443"]}],labels:["Kasus Aktif","Sembuh","Meninggal"]},options:{responsive:!0,maintainAspectRatio:!1}})};var map,infoWindow,mapStyle=[{elementType:"geometry",stylers:[{color:"#f5f5f5"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f5f5"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]}];let coronaGlobalData;window.onload=(()=>{initMap(),getCountriesData(),getHistoricalData(),getWorldCoronaData()});let mapCircles=[];const worldWideSelection={name:"Seluruh Dunia",value:"www",selected:!0};var casesTypeColors={cases:"#cc1034",active:"#9d80fe",recovered:"#7dd71d",deaths:"#fb4443"};const mapCenter={lat:-5,lng:120};function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:mapCenter,zoom:3.2,minZoom:3,styles:mapStyle,scrollwheel:!1}),infoWindow=new google.maps.InfoWindow}const changeDataSelection=(e,t)=>{clearTheMap(),showDataOnMap(coronaGlobalData,t),setActiveTab(e)},setActiveTab=e=>{document.querySelector(".card.active").classList.remove("active"),e.classList.add("active")},clearTheMap=()=>{for(let e of mapCircles)e.setMap(null)},setMapCenter=(e,t,a)=>{map.panTo({lat:e,lng:t}),map.setZoom(a)},initDropdown=e=>{$(".ui.dropdown").dropdown({values:e,onChange:function(e,t){e!==worldWideSelection.value?getCountryData(e):getWorldCoronaData()}})},setSearchList=e=>{let t=[];t.push(worldWideSelection),e.forEach(e=>{t.push({name:e.country,value:e.countryInfo.iso3}),initDropdown(t)})},getCountriesData=()=>{fetch("https://corona.lmao.ninja/v2/countries").then(e=>e.json()).then(e=>{coronaGlobalData=e,setSearchList(e),showDataOnMap(e),showDataInTable(e)})},getCountryData=e=>{fetch("https:/disease.sh/v3/covid-19/countries/"+e).then(e=>e.json()).then(e=>{setMapCenter(e.countryInfo.lat,e.countryInfo.long,2),setStatsData(e)})},getWorldCoronaData=()=>{fetch("https://disease.sh/v3/covid-19/all").then(e=>e.json()).then(e=>{setStatsData(e),setMapCenter(mapCenter.lat,mapCenter.lng,3)})},setStatsData=e=>{let t=numeral(e.todayCases).format("+0,0"),a=numeral(e.todayRecovered).format("+0,0"),o=numeral(e.todayDeaths).format("+0,0"),l=numeral(e.cases).format("0.0a"),r=numeral(e.recovered).format("0.0a"),n=numeral(e.deaths).format("0.0a");document.querySelector(".total-number").innerHTML=t,document.querySelector(".recovered-number").innerHTML=a,document.querySelector(".deaths-number").innerHTML=o,document.querySelector(".cases-total").innerHTML=`${l} Total`,document.querySelector(".recovered-total").innerHTML=`${r} Total`,document.querySelector(".deaths-total").innerHTML=`${n} Total`},getHistoricalData=()=>{fetch("https://disease.sh/v3/covid-19/historical/all?lastdays=120").then(e=>e.json()).then(e=>{let t=buildChartData(e);buildChart(t)})},showDataOnMap=(e,t="cases")=>{e.map(e=>{let a={lat:e.countryInfo.lat,lng:e.countryInfo.long};var o=new google.maps.Circle({strokeColor:casesTypeColors[t],strokeOpacity:.5,strokeWeight:2,fillColor:casesTypeColors[t],fillOpacity:.35,map:map,center:a,radius:.28*e[t]});mapCircles.push(o);var l=`\n            <div class="info-container">\n                <div class="info-flag" style="background-image: url(${e.countryInfo.flag})"></div>\n                <div class="info-name">\n                    ${e.country}\n                </div>\n                <div class="info-confirmed">\n                    Total Kasus: ${numeral(e.cases).format("0,0")}\n                </div>\n                <div class="info-deaths">\n                   Meninggal: ${numeral(e.deaths).format("0,0")} \n                </div>\n                <div class="info-recovered">\n                   Sembuh: ${numeral(e.recovered).format("0,0")}        \n                </div>                \n            </div>\n          `,r=new google.maps.InfoWindow({content:l,position:o.center});google.maps.event.addListener(o,"mouseover",function(){r.open(map)}),google.maps.event.addListener(o,"mouseout",function(){r.close()})})},showDataInTable=e=>{var t="";e.forEach(e=>{t+=`\n            <tr>\n                <td id="img-flexbox"><div class="country-img" style="background-image: url(${e.countryInfo.flag})"></div>${e.country}</td>\n                <td>${numeral(e.cases).format("0,0")}</td>\n            </tr>\n        `,document.getElementById("table-data").innerHTML=t})};